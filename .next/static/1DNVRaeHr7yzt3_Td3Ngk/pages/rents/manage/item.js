(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"09aj":function(e,t,a){"use strict";a.r(t);var r=a("6BQ9"),s=a.n(r),n=a("ln6h"),o=a.n(n),c=a("O40h"),i=a("0iUn"),u=a("sLSF"),d=a("MI3g"),l=a("a7VT"),m=a("AT/M"),h=a("Tit0"),p=a("vYYK"),f=a("q1tI"),v=a.n(f),b=a("z8k1"),g=a("TbSc"),y=a("+6Dn"),O=a("vFsZ"),w=a("QetY"),P=a("5Yp1"),S=a("dbDy"),E=a("oZBQ"),M=(a("8cHP"),function(e){function t(){var e,a;Object(i.default)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return a=Object(d.default)(this,(e=Object(l.default)(t)).call.apply(e,[this].concat(s))),Object(p.a)(Object(m.default)(a),"state",{errorMessagePayment:"",successMessagePayment:"",loadingPayment:!1,disabledPayment:!1,errorMessageOverdue:"",successMessageOverdue:"",loadingOverdue:!1,disabledOverdue:!1,totalFee:""}),Object(p.a)(Object(m.default)(a),"onSubmitPayment",function(){var e=Object(c.default)(o.a.mark(function e(t){var r,s,n,c,i,u;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=Object(S.a)(a.props.address),s="rent"===a.props.manage,n=s?"Action successful. Awaiting payment from renter.":"Transaction successful.",a.setState({loadingPayment:!0,errorMessagePayment:"",errorMessageOverdue:""}),e.prev=5,e.next=8,E.a.eth.getAccounts();case 8:return c=e.sent,e.next=11,r.methods.calculateFee().call();case 11:if(i=e.sent,u=E.a.utils.toWei("0.01","ether"),!s){e.next=18;break}return e.next=16,r.methods.reclaimItem().send({from:c[0]});case 16:e.next=20;break;case 18:return e.next=20,r.methods.returnItem().send({from:c[0],value:u});case 20:a.setState({totalFee:i,disabledPayment:!0,disabledOverdue:!0,successMessagePayment:n}),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(5),a.setState({errorMessagePayment:e.t0.message});case 26:a.setState({loadingPayment:!1});case 27:case"end":return e.stop()}},e,null,[[5,23]])}));return function(t){return e.apply(this,arguments)}}()),Object(p.a)(Object(m.default)(a),"onSubmitOverdue",function(){var e=Object(c.default)(o.a.mark(function e(t){var r,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=Object(S.a)(a.props.address),a.setState({loadingOverdue:!0,errorMessageOverdue:"",errorMessagePayment:""}),e.prev=3,e.next=6,E.a.eth.getAccounts();case 6:return s=e.sent,e.next=9,r.methods.chargeOverdueItem().send({from:s[0]});case 9:a.setState({disabledOverdue:!0,disabledPayment:!0,successMessageOverdue:"Action successful. Deposit received"}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),a.setState({errorMessageOverdue:e.t0.message});case 15:a.setState({loadingOverdue:!1});case 16:case"end":return e.stop()}},e,null,[[3,12]])}));return function(t){return e.apply(this,arguments)}}()),a}return Object(h.default)(t,e),Object(u.default)(t,[{key:"renderCards",value:function(){var e=this.props,t=e.address,a=e.productName,r=e.description,n=e.rentalFee,o=e.deposit,c=e.maxDuration,i=[{header:a,meta:"Product Name",description:r},{header:t,meta:"Product ID",description:"A unique product ID attached to this product",style:{overflowWrap:"break-word"}},{header:e.owner,meta:"Address of Owner",description:"The owner created the contract and specified the details of the rent",style:{overflowWrap:"break-word"}},{header:(60*n*60).toFixed(5).toString(),meta:"Rental Fee (ether per hour)",description:"The rental fee per hour. The total rental fee will be automatically calculated per second basis"},{header:o,meta:"Deposit (ether)",description:"The borrower need to pay the specified amount of deposit fee to the contract. The deposit will be credited back to the borrower after the item is returned"},{header:(s()(c)/60/60).toString(),meta:"Maximum Duration to Rent (hour(s))",description:"The maximum hour(s) available to rent. The deposit will be released to the owner if the borrower fails to return the item before the specified hours"}];return v.a.createElement(b.a.Group,{centered:!0,items:i})}},{key:"showSummary",value:function(){var e=this.state.totalFee?this.state.totalFee:this.props.totalFee;v.a.createElement(g.a,{icon:"file alternate outline",header:"Here is the summary of the rent",content:"Payable : "+e})}},{key:"render",value:function(){var e="rent"===this.props.manage,t="PUBLISHED"!==this.props.inState,a=e?"Received item from borrower and request for payment":"Pay rent fees and retrieve deposit",r=e?"Item Received":"Pay Rent",s=!1;return""!==this.state.totalFee?s=!0:e||"AWAITPAYMENT"!==this.props.inState||(s=!0),v.a.createElement(P.a,null,v.a.createElement("h3",null,"Product Details"),v.a.createElement(y.a,null,v.a.createElement(y.a.Row,null,this.renderCards()),s&&v.a.createElement(y.a.Row,null,this.showSummary()),t&&v.a.createElement(y.a.Row,{centered:!0},v.a.createElement(O.a,{onSubmit:this.onSubmitPayment,error:!!this.state.errorMessagePayment,success:!!this.state.successMessagePayment},v.a.createElement(O.a.Field,null,v.a.createElement("label",null,a),v.a.createElement(w.a,{primary:!0,loading:this.state.loadingPayment,disabled:this.state.disabledPayment||e&&"RENTED"!==this.props.inState},r)),v.a.createElement(g.a,{error:!0,header:"Oops!",content:this.state.errorMessagePayment}),v.a.createElement(g.a,{success:!0,header:"Success!",content:this.state.successMessagePayment}))),e&&t&&v.a.createElement(y.a.Row,{centered:!0},v.a.createElement(O.a,{onSubmit:this.onSubmitOverdue,error:!!this.state.errorMessageOverdue,success:!!this.state.successMessageOverdue},v.a.createElement(O.a.Field,null,v.a.createElement("label",null,"Retrieve deposit from overdue item"),v.a.createElement(w.a,{primary:!0,loading:this.state.loadingOverdue,disabled:this.state.disabledOverdue||"RENTED"!==this.props.inState},"Overdue Item")),v.a.createElement(g.a,{error:!0,header:"Oops!",content:this.state.errorMessageOverdue}),v.a.createElement(g.a,{success:!0,header:"Success!",content:this.state.successMessageOverdue})))))}}],[{key:"getInitialProps",value:function(){var e=Object(c.default)(o.a.mark(function e(t){var a,r,s,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(S.a)(t.query.address),e.next=3,a.methods.getSummary().call();case 3:return r=e.sent,e.next=6,a.methods.calculateFee().call();case 6:return s=e.sent,e.next=9,a.methods.getState().call();case 9:return n=e.sent,e.abrupt("return",{manage:t.query.manage,address:t.query.address,totalFee:s,inState:n,productName:r[0],description:r[1],rentalFee:E.a.utils.fromWei(r[2],"ether"),deposit:E.a.utils.fromWei(r[3],"ether"),maxDuration:r[4],owner:r[5]});case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),t}(f.Component));t.default=M},Dk6u:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/rents/manage/item",function(){var e=a("09aj");return{page:e.default||e}}])}},[["Dk6u",1,0]]]);